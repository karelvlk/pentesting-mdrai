# Pentesting

## Quickstart

Run whole simulation cronjob by following command:

```bash
./scripts/run_cronjob.sh
```

## Script documentations

`CONFIG.sh`

- configuration of pentesting scripts
- always need to verify and configure IPs (bevause of DHCP leasing)

`simulate-normal-activity.sh`

- web browsing simulation
- email sending simulation
- file download simulation
- API interaction simulation
- video streaming simulation
- DNS lookup simulation
- social media interaction simulation
- file R/W operations simulation
- VoIP call simulation
- authenticated web application interaction
  - also simulates logging into a vulnerable DVWA application in which it also:
    - pings the router (for comparison with the `8_injection-command.sh` attack)
    - query a user from the sql database (to compare with the `9_injection-sql.sh` attack)
    - writes a message to the guestbook (to compare with `11_cross-site-scripting.sh` attack)

`0_nmap-all.sh`

- All types of scan via nmap

`1_nmap-tcpsyn.sh`

- TCP SYN scan via nmap

`2_nmap-udp.sh`

- UDP scan via nmap

`3_nmap-version.sh`

- Version scan via nmap

`4_nmap-os.sh`

- Operating system scan via nmap

`5_ffuf-url.sh`

- Web app fuzzing to discover valid url addresses
- URL dictionary from `utils/big.txt`

`6_ffuf-file.sh`

- Web app fuzzing to discover existing files with .php,.html,.txt extensions
- filenames dictionary from `utils/raft-medium-words-lowercase.txt`

`7_hydra.sh`

- Brute-force of DVWA introductory menu via Hydra
- first you need to get the PHPSESSID
- then execute an attack in which it tries all combinations of names and passwords from `utils/top-usernames-shortlist.txt` and `utils/10-million-password-list-top-1000.txt`

`8_injection-command.sh`

- Command injection attack on DVWA
- first you need to get the TOKEN and PHPSESSID to log in to DVWA
- then exploits a command vulnerability in pinging and simply prints the root files and passwords from /cat/shadow via curl

`9_injection-sql.sh`

- SQL injection attack on DVWA via sqlmap
- first you need to get the TOKEN and PHPSESSID to log into DVWA
- then perform several sqlmap attacks:
  - lists all available databases
  - lists all available tables
  - dumps all columns from the users table
  - lists all users and cracks their passwords

`10_cross-site-scripting.sh`

- XSS attack on DVWA
- first you need to get the TOKEN and PHPSESSID to log into DVWA
- then perform 2 types of xss attack:
  - reflected - inserts a malicious script into the url
  - stored - save the malicious script to the web via guestbook form

`11_mitm-arp-msf.sh`

- Man-in-the-middle attack on the communication between the router and metasploitable via ettercap
- overwhelms the arp cache for 10 minutes and starts sending all communication through the intermediary (kali-linux attacker)

`12_mitm-arp-win.sh`

- Man-in-the-middle attack on communication between router and windows via ettercap
- overwhelms the arp cache for 10 minutes and starts sending all communication through the intermediary (kali-linux attacker)

`13_backdoor-vsftp.sh`

- Backdoor exploit vsftpd 2.3.4 weakness on metasploitable
- after successfully gaining root access, it then:
  - dumps user
  - dumps file
  - dumps and downloads a file with encrypted passwords
  - dumps all interfaces
  - executes a potentially dangerous script (this could be ransomware, in our case it just restarts the device)

### Obsolated

`obsolated/0_simulate-activity.sh`

- simulates visiting web pages and other links found
- also simulates logging into a vulnerable DVWA application in which it also:
  - pings the router (for comparison with the `8_injection-command.sh` attack)
  - query a user from the sql database (to compare with the `9_injection-sql.sh` attack)
  - writes a message to the guestbook (to compare with `11_cross-site-scripting.sh` attack)

`obsolated/14_reverseshell-win.sh`

- Reverse shell attack on windows 11 via metasploit
- not fully automatic, for a successful connection the windows user needs to run malware.exe and at the same time have antivirus and firewall disabled
- after a successful connection, execute "background" command in kali-linux and then the post-exploit script executes:
  - keyboard logging
  - dump the file
  - dump all interfaces
  - listing the arp, route and netstat tables
  - listing all processes
  - mouse clicks
  - take a screenshot
  - list system information
